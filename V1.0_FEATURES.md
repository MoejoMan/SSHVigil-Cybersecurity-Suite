# Tripwire v1.0 Features

## New in v1.0

### 1. CSV Export in Live Mode
- **Flag**: `--export-csv <path>`
- **What it does**: Continuously writes threat analysis to CSV file during live monitoring
- **Usage**: `python main.py --log-file /var/log/auth.log --live --export-csv threats.csv`
- **Benefit**: Export live threat data for real-time dashboards or external alerting

### 2. Non-Interactive Mode
- **Flag**: `--non-interactive`
- **What it does**: Suppresses all prompts in batch mode for automation
- **Usage**: `python main.py --log-file /var/log/auth.log --non-interactive --export-csv results.csv`
- **Benefit**: Perfect for cron jobs, systemd timers, and CI/CD pipelines

### 3. IP Validation
- **Automatic**: All extracted IPs are validated before processing
- **What it does**: Rejects invalid IP addresses (malformed strings, injected data)
- **Benefit**: Prevents corruption of blocklists and analysis results

### 4. IP Whitelist
- **Flag**: `--whitelist <path>`
- **Format**: One IP per line, comments start with `#`
- **Usage**: `python main.py --log-file /var/log/auth.log --live --whitelist trusted_ips.txt --export-blocklist blocklist.txt`
- **Benefit**: Prevents accidental self-bans and protects trusted infrastructure

**Example whitelist file:**
```
# Trusted IPs
192.168.1.1
10.0.0.5
203.0.113.100
```

### 5. Cross-Platform PID Locking
- **What it does**: Prevents multiple instances from using the same blocklist file
- **Windows**: Uses `%TEMP%` directory instead of `/tmp`
- **All platforms**: Validates that PID is actually still running
- **Benefit**: Safe concurrent usage on any OS

## Example Usage Scenarios

### Cron job (automation)
```bash
python3 main.py \
  --log-file /var/log/auth.log \
  --non-interactive \
  --export-csv /var/log/analysis.csv \
  --export-blocklist /etc/blocklist.txt \
  --blocklist-threshold HIGH \
  --whitelist /etc/trusted_ips.txt
```

### Live monitoring with CSV export
```bash
python3 main.py \
  --log-file /var/log/auth.log \
  --live \
  --refresh 5 \
  --export-csv threats.csv \
  --whitelist trusted_ips.txt \
  --quiet
```

### Strict mode with whitelist
```bash
python3 main.py \
  --log-file /var/log/auth.log \
  --strict \
  --whitelist admins.txt \
  --export-blocklist blocklist.txt
```

## Breaking Changes
None. All v0.9.1 features remain backward compatible.

## Test Coverage
All 8 existing tests pass. New features automatically tested via integration.
